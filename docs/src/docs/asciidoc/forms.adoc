= Forms
:doctype: book
:icons: font
:source-highlighter: highlight.js
:toc: left
:toclevels: 3

include::_attributes.adoc[]

[NOTE]
Form state and validation (`FormState`, `Validators`) are part of `tamboui-widgets` and work at any API level.
The `formField()` and `form()` builders shown here are Toolkit DSL conveniencesâ€”see link:api-levels.html#toolkit-dsl[Toolkit DSL] for an introduction.

{project-name} provides high-level form abstractions to simplify building interactive forms with labels, validation, and centralized state management.

== Overview

Building forms traditionally requires significant boilerplate:

* Individual state declarations for each field
* Manual label + input pairing
* Repetitive styling
* Custom helper methods

The form abstractions reduce this to concise, declarative code:

[source,java]
----
include::{snippets-dir}/dev/tamboui/docs/snippets/FormsSnippets.java[tags=overview]
----

== Form Fields

The `formField()` factory creates a labeled input field that pairs a label with an input widget.

=== Basic Usage

[source,java]
----
import static dev.tamboui.toolkit.Toolkit.*;

include::{snippets-dir}/dev/tamboui/docs/snippets/FormsSnippets.java[tags=basic-usage]
----

=== Field Types

FormFieldElement supports multiple input types:

[cols="1,2,2",options="header"]
|===
|Type |Description |State Class

|`TEXT` (default)
|Single-line text input
|`TextInputState`

|`CHECKBOX`
|Boolean checkbox with [x] rendering
|`BooleanFieldState`

|`TOGGLE`
|On/off toggle switch
|`BooleanFieldState`

|`SELECT`
|Dropdown selection
|`SelectFieldState`
|===

==== Text Fields

[source,java]
----
include::{snippets-dir}/dev/tamboui/docs/snippets/FormsSnippets.java[tags=text-fields]
----

==== Password Fields

Use `maskedField()` in the FormState builder for password fields:

[source,java]
----
include::{snippets-dir}/dev/tamboui/docs/snippets/FormsSnippets.java[tags=password-fields-builder]
----

When used with `FormElement`, masking is applied automatically.
For `formField()`, you can use `.masked()` explicitly:

[source,java]
----
include::{snippets-dir}/dev/tamboui/docs/snippets/FormsSnippets.java[tags=password-fields-masked]
----

The actual text is stored in the state; only the display is masked.

==== Boolean Fields (Checkbox/Toggle)

[source,java]
----
include::{snippets-dir}/dev/tamboui/docs/snippets/FormsSnippets.java[tags=boolean-fields]
----

==== Select Fields

[source,java]
----
include::{snippets-dir}/dev/tamboui/docs/snippets/FormsSnippets.java[tags=select-fields]
----

=== Styling

FormFieldElement supports comprehensive styling options:

[source,java]
----
include::{snippets-dir}/dev/tamboui/docs/snippets/FormsSnippets.java[tags=styling-options]
----

=== CSS Selectors

FormFieldElement exposes these CSS child selectors:

[cols="1,2",options="header"]
|===
|Selector |Description

|`FormFieldElement-label`
|The label text style

|`FormFieldElement-input`
|The input wrapper

|`FormFieldElement-error`
|The inline error message style
|===

Example TCSS:

[source,css]
----
FormFieldElement-label {
    color: gray;
}

FormFieldElement-error {
    color: red;
}
----

== Form State

`FormState` provides centralized state management for all form fields, eliminating the need for individual state declarations.

=== Creating Form State

[source,java]
----
include::{snippets-dir}/dev/tamboui/docs/snippets/FormsSnippets.java[tags=form-state-creation]
----

=== Accessing Values

[source,java]
----
include::{snippets-dir}/dev/tamboui/docs/snippets/FormsSnippets.java[tags=accessing-values]
----

== Validation

The validation framework provides built-in validators and supports custom validation logic.

=== Built-in Validators

[cols="1,2,2",options="header"]
|===
|Validator |Description |Example

|`required()`
|Field must not be empty
|`Validators.required()`

|`email()`
|Valid email format
|`Validators.email()`

|`minLength(n)`
|Minimum n characters
|`Validators.minLength(3)`

|`maxLength(n)`
|Maximum n characters
|`Validators.maxLength(100)`

|`pattern(regex)`
|Matches regex pattern
|`Validators.pattern("\\d{5}")`

|`range(min, max)`
|Numeric value in range
|`Validators.range(1, 100)`
|===

=== Using Validators

[source,java]
----
include::{snippets-dir}/dev/tamboui/docs/snippets/FormsSnippets.java[tags=using-validators]
----

=== Custom Error Messages

All built-in validators accept an optional custom message:

[source,java]
----
include::{snippets-dir}/dev/tamboui/docs/snippets/FormsSnippets.java[tags=custom-error-messages]
----

=== Triggering Validation

[source,java]
----
include::{snippets-dir}/dev/tamboui/docs/snippets/FormsSnippets.java[tags=triggering-validation]
----

=== Custom Validators

Create custom validators using the `Validator` functional interface:

[source,java]
----
include::{snippets-dir}/dev/tamboui/docs/snippets/FormsSnippets.java[tags=custom-validators]
----

=== Composing Validators

Validators can be composed using `and()`:

[source,java]
----
include::{snippets-dir}/dev/tamboui/docs/snippets/FormsSnippets.java[tags=composing-validators]
----

== Form Container

`FormElement` provides a container for managing multiple form fields with optional grouping.

=== Basic Usage

[source,java]
----
include::{snippets-dir}/dev/tamboui/docs/snippets/FormsSnippets.java[tags=form-container-basic]
----

=== Grouping Fields

[source,java]
----
include::{snippets-dir}/dev/tamboui/docs/snippets/FormsSnippets.java[tags=grouping-fields]
----

=== Form Submission

FormElement supports two submission patterns:

==== Submit on Enter

When enabled, pressing Enter in any text field triggers form submission:

[source,java]
----
include::{snippets-dir}/dev/tamboui/docs/snippets/FormsSnippets.java[tags=submit-on-enter]
----

==== Programmatic Submit (Button)

Call `submit()` from a button or other trigger:

[source,java]
----
include::{snippets-dir}/dev/tamboui/docs/snippets/FormsSnippets.java[tags=programmatic-submit]
----

==== Validation on Submit

By default, `submit()` validates all fields before calling the `onSubmit` callback.

IMPORTANT: If validation fails, the `onSubmit` callback is *not* called and `submit()` returns `false`.

[source,java]
----
include::{snippets-dir}/dev/tamboui/docs/snippets/FormsSnippets.java[tags=validation-on-submit]
----

To always call `onSubmit` regardless of validation:

[source,java]
----
include::{snippets-dir}/dev/tamboui/docs/snippets/FormsSnippets.java[tags=skip-validation-on-submit]
----

=== Arrow Key Navigation

By default, Up/Down arrow keys only work in select fields (to change selection).
Enable `arrowNavigation` to allow Up/Down to move between fields:

[source,java]
----
include::{snippets-dir}/dev/tamboui/docs/snippets/FormsSnippets.java[tags=arrow-navigation]
----

When enabled:

* **Text fields**: Up/Down navigate to previous/next field (like Tab/Shift+Tab)
* **Boolean fields** (checkbox, toggle): Up/Down navigate to previous/next field
* **Select fields**: Up/Down still change the selection (unchanged behavior)

== Complete Example

Here's a complete form example using all the abstractions:

[source,java]
----
include::{snippets-dir}/dev/tamboui/docs/snippets/FormsSnippets.java[tags=complete-example]
----

== State Classes Reference

=== TextInputState

[source,java]
----
include::{snippets-dir}/dev/tamboui/docs/snippets/FormsSnippets.java[tags=text-input-state-reference]
----

=== BooleanFieldState

[source,java]
----
include::{snippets-dir}/dev/tamboui/docs/snippets/FormsSnippets.java[tags=boolean-field-state-reference]
----

=== SelectFieldState

[source,java]
----
include::{snippets-dir}/dev/tamboui/docs/snippets/FormsSnippets.java[tags=select-field-state-reference]
----

== Migration Guide

To migrate from manual form construction to the new abstractions:

=== Before

[source,java]
----
include::{snippets-dir}/dev/tamboui/docs/snippets/FormsSnippets.java[tags=migration-before]
----

=== After

[source,java]
----
include::{snippets-dir}/dev/tamboui/docs/snippets/FormsSnippets.java[tags=migration-after]
----
