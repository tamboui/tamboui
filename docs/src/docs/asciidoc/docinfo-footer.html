<!-- Navigation data -->
<script>
var TAMBOUI_PAGES = [
    { href: 'index.html', title: 'Home', short: 'Home' },
    { href: 'getting-started.html', title: 'Getting Started', short: 'Getting Started' },
    { href: 'core-concepts.html', title: 'Core Concepts', short: 'Core Concepts' },
    { href: 'widgets.html', title: 'Widgets Reference', short: 'Widgets' },
    { href: 'demos.html', title: 'Demo Gallery', short: 'Demos' },
    { href: 'api-levels.html', title: 'API Levels', short: 'API Levels' },
    { href: 'styling.html', title: 'CSS Styling', short: 'CSS Styling' },
    { href: 'bindings.html', title: 'Bindings and Actions', short: 'Bindings' },
    { href: 'mvc-architecture.html', title: 'MVC Model', short: 'MVC Model' },
    { href: 'developer-guide.html', title: 'Developer Guide', short: 'Developer Guide' },
    // Generated Javadoc (published by the docs build under "api/")
    { href: 'api/index.html', title: 'API', short: 'API' }
];
</script>

<!-- Theme toggle and navigation enhancement -->
<script>
(function() {
    'use strict';

    // ===== Theme Toggle =====
    function getTheme() {
        return localStorage.getItem('tamboui-theme') || 'auto';
    }

    function setTheme(theme) {
        localStorage.setItem('tamboui-theme', theme);
        applyTheme(theme);
    }

    function applyTheme(theme) {
        if (theme === 'dark') {
            document.documentElement.setAttribute('data-theme', 'dark');
        } else if (theme === 'light') {
            document.documentElement.setAttribute('data-theme', 'light');
        } else {
            document.documentElement.removeAttribute('data-theme');
        }
    }

    function createThemeToggle() {
        var header = document.getElementById('header');
        if (!header) return;

        var toggle = document.createElement('button');
        toggle.className = 'theme-toggle';
        toggle.setAttribute('aria-label', 'Toggle theme');
        toggle.innerHTML = '<svg class="icon-sun" viewBox="0 0 24 24" width="20" height="20"><path fill="currentColor" d="M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0a.996.996 0 000-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"/></svg><svg class="icon-moon" viewBox="0 0 24 24" width="20" height="20"><path fill="currentColor" d="M12 3a9 9 0 109 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 01-4.4 2.26 5.403 5.403 0 01-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"/></svg>';

        toggle.addEventListener('click', function() {
            var current = getTheme();
            var next;
            if (current === 'auto') {
                next = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'light' : 'dark';
            } else if (current === 'dark') {
                next = 'light';
            } else {
                next = 'dark';
            }
            setTheme(next);
        });

        var actions = document.createElement('div');
        actions.className = 'header-actions';
        actions.appendChild(toggle);
        var details = header.querySelector('.details');
        if (details) {
            header.insertBefore(actions, details);
        } else {
            header.appendChild(actions);
        }
    }

    // ===== Cross-page Navigation =====
    function getCurrentPage() {
        var path = window.location.pathname;
        var page = path.substring(path.lastIndexOf('/') + 1) || 'index.html';
        return page;
    }

    function createTopNavigation() {
        var header = document.getElementById('header');
        if (!header) return;

        var currentPage = getCurrentPage();

        // Create top navigation bar
        var nav = document.createElement('nav');
        nav.className = 'top-nav';

        TAMBOUI_PAGES.forEach(function(page) {
            var a = document.createElement('a');
            a.href = page.href;
            a.textContent = page.short;
            if (page.href === currentPage) {
                a.className = 'current';
            }
            nav.appendChild(a);
        });

        var actions = header.querySelector('.header-actions');
        if (actions) {
            header.insertBefore(nav, actions);
        } else {
            header.appendChild(nav);
        }

        // Create mobile navigation
        createMobileNavigation(header, currentPage);
    }

    function createMobileNavigation(header, currentPage) {
        // Create hamburger button
        var toggle = document.createElement('button');
        toggle.className = 'mobile-nav-toggle';
        toggle.setAttribute('aria-label', 'Toggle navigation menu');
        toggle.innerHTML = '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 12h18M3 6h18M3 18h18"/></svg>';

        var actions = header.querySelector('.header-actions');
        if (actions) {
            header.insertBefore(toggle, actions);
        } else {
            header.appendChild(toggle);
        }

        // Create mobile nav drawer
        var mobileNav = document.createElement('nav');
        mobileNav.className = 'mobile-nav';

        TAMBOUI_PAGES.forEach(function(page) {
            var a = document.createElement('a');
            a.href = page.href;
            a.textContent = page.title;
            if (page.href === currentPage) {
                a.className = 'current';
            }
            mobileNav.appendChild(a);
        });

        document.body.appendChild(mobileNav);

        // Toggle mobile nav
        toggle.addEventListener('click', function(e) {
            e.stopPropagation();
            mobileNav.classList.toggle('open');
            var isOpen = mobileNav.classList.contains('open');
            toggle.innerHTML = isOpen
                ? '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 18L18 6M6 6l12 12"/></svg>'
                : '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 12h18M3 6h18M3 18h18"/></svg>';
        });

        // Close on outside click
        document.addEventListener('click', function(e) {
            if (!mobileNav.contains(e.target) && !toggle.contains(e.target)) {
                mobileNav.classList.remove('open');
                toggle.innerHTML = '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 12h18M3 6h18M3 18h18"/></svg>';
            }
        });
    }

    // ===== Version selector (for multi-version docs at e.g. tamboui.dev/docs) =====
    // When published, docs live at docs/<path>/ (e.g. docs/main/, docs/0.1.0/).
    // versions.json format: object mapping display name -> path segment (relative to docs/).
    // Example: { "main": "main", "0.1.0": "0.1.0", "latest": "0.1.0", "0.2.0-snapshot": "main" }
    // URL for a version is: <origin>/docs/<pathSegment>/<page>
    // Flat structure (e.g. /docs/index.html with no version segment) is supported: we fetch
    // versions.json from same dir and show dropdown; current selection is first entry.
    function getDocsVersionContext() {
        var pathname = window.location.pathname;
        var match = pathname.match(/\/docs\/([^/]+)\/(.*)/);
        if (match) {
            var segment = match[1];
            var rest = match[2] || 'index.html';
            if (segment.indexOf('.') !== -1) {
                return null;
            }
            return {
                docsBase: window.location.origin + pathname.substring(0, pathname.indexOf('/docs/') + 5),
                currentPathSegment: segment,
                pathInVersion: rest
            };
        }
        return null;
    }

    function createVersionSelector() {
        var header = document.getElementById('header');
        if (!header) return;

        var ctx = getDocsVersionContext();
        var pathname = window.location.pathname;
        var versionsUrl;
        if (ctx) {
            versionsUrl = ctx.docsBase + '/versions.json';
        } else if (pathname.indexOf('/docs/') !== -1) {
            versionsUrl = window.location.origin + pathname.substring(0, pathname.indexOf('/docs/') + 5) + '/versions.json';
        } else {
            versionsUrl = 'versions.json';
        }

        fetch(versionsUrl).then(function(res) {
            if (!res.ok) return null;
            return res.json();
        }).then(function(versionMap) {
            if (!versionMap || typeof versionMap !== 'object') return;
            var entries = Object.keys(versionMap).map(function(name) {
                return { name: name, path: versionMap[name] };
            });
            if (entries.length === 0) return;

            var currentPath = ctx ? ctx.currentPathSegment : entries[0].path;
            var selectedName = entries[0].name;
            for (var i = 0; i < entries.length; i++) {
                if (entries[i].path === currentPath) {
                    selectedName = entries[i].name;
                    break;
                }
            }

            var wrap = document.createElement('div');
            wrap.className = 'version-selector-wrap';

            var label = document.createElement('span');
            label.className = 'version-selector-label';
            label.textContent = 'Version ';
            wrap.appendChild(label);

            var select = document.createElement('select');
            select.className = 'version-selector';
            select.setAttribute('aria-label', 'Documentation version');
            entries.forEach(function(e) {
                var opt = document.createElement('option');
                opt.value = e.path;
                opt.textContent = e.name;
                if (e.name === selectedName) opt.selected = true;
                select.appendChild(opt);
            });

            select.addEventListener('change', function() {
                var pathSegment = select.value;
                if (ctx && pathSegment === ctx.currentPathSegment) return;
                if (ctx) {
                    window.location.href = ctx.docsBase + '/' + pathSegment + '/' + ctx.pathInVersion;
                } else {
                    var base = window.location.origin + pathname.substring(0, pathname.indexOf('/docs/') + 5);
                    var page = pathname.substring(pathname.lastIndexOf('/') + 1) || 'index.html';
                    window.location.href = base + '/' + pathSegment + '/' + page;
                }
            });

            wrap.appendChild(select);

            var actions = header.querySelector('.header-actions');
            var themeToggle = header.querySelector('.theme-toggle');
            if (actions && themeToggle) {
                actions.insertBefore(wrap, themeToggle);
            } else {
                header.appendChild(wrap);
            }
        }).catch(function() {});
    }

    function createPrevNextNavigation() {
        var content = document.getElementById('content');
        var footer = document.getElementById('footer');
        if (!content || !footer) return;

        var currentPage = getCurrentPage();
        var currentIndex = -1;

        TAMBOUI_PAGES.forEach(function(page, index) {
            if (page.href === currentPage) {
                currentIndex = index;
            }
        });

        if (currentIndex === -1) return;

        var prev = currentIndex > 0 ? TAMBOUI_PAGES[currentIndex - 1] : null;
        var next = currentIndex < TAMBOUI_PAGES.length - 1 ? TAMBOUI_PAGES[currentIndex + 1] : null;

        if (!prev && !next) return;

        var nav = document.createElement('nav');
        nav.className = 'prev-next-nav';

        if (prev) {
            nav.innerHTML += '<a href="' + prev.href + '" class="prev"><span class="label">Previous</span><span class="title">' + prev.title + '</span></a>';
        } else {
            nav.innerHTML += '<span class="prev placeholder"></span>';
        }

        if (next) {
            nav.innerHTML += '<a href="' + next.href + '" class="next"><span class="label">Next</span><span class="title">' + next.title + '</span></a>';
        } else {
            nav.innerHTML += '<span class="next placeholder"></span>';
        }

        // Insert before footer
        footer.parentNode.insertBefore(nav, footer);
    }

    // ===== Initialize =====
    document.addEventListener('DOMContentLoaded', function() {
        createThemeToggle();
        createTopNavigation();
        createVersionSelector();
        createPrevNextNavigation();
    });
})();
</script>
